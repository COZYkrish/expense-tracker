<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Expense Tracker</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { background: #181a2a; color: #fff; }
        .dashboard-container { max-width: 900px; margin: 40px auto; background: rgba(24,26,42,0.92); border-radius: 24px; box-shadow: 0 8px 32px #00f2fe33; padding: 40px 32px; }
        h1 { font-size: 2.2rem; margin-bottom: 18px; color: #00f2fe; }
        .summary { font-size: 1.3rem; margin-bottom: 24px; }
        .chart-section { margin: 32px 0; }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <h1>Admin Dashboard</h1>
        <div class="summary">
            <strong>Total Expenses:</strong> ${{ total | round(2) }}<br>
            <strong>Total Records:</strong> {{ expenses|length }}
        </div>
        <div class="chart-section">
            <h2>Category-wise Analytics</h2>
            <canvas id="adminCategoryChart" width="400" height="220"></canvas>
        </div>
        <div class="table-section">
            <h2>All Expenses</h2>
            <table id="expenses-table">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Name</th>
                        <th>Amount ($)</th>
                        <th>Category</th>
                        <th>Date</th>
                    </tr>
                </thead>
                <tbody>
                    {% for expense in expenses %}
                    <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ expense.name }}</td>
                        <td>{{ '%.2f'|format(expense.amount) }}</td>
                        <td>{{ expense.category if expense.category else 'Other' }}</td>
                        <td>{{ expense.date if expense.date else '' }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    <script id="admin-category-data-json" type="application/json">{{ category_data|tojson }}</script>
    <script>
        // Category-wise chart for admin
        const adminCategoryData = JSON.parse(document.getElementById('admin-category-data-json').textContent);
        const adminChartLabels = Object.keys(adminCategoryData);
        const adminChartData = Object.values(adminCategoryData);
        const adminChartColors = [
            '#00f2fe', '#4facfe', '#43e97b', '#38f9d7', '#fa709a', '#ffb347', '#ff6b6b', '#3a3a7c', '#e63946', '#bdbdfc'
        ];
        if (adminChartLabels.length > 0) {
            const ctx = document.getElementById('adminCategoryChart').getContext('2d');
            new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: adminChartLabels,
                    datasets: [{
                        data: adminChartData,
                        backgroundColor: adminChartColors,
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { position: 'bottom' },
                        title: { display: false }
                    }
                }
            });
        }
    </script>
</body>
</html>
